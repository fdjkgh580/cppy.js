{"version":3,"sources":["jquery.cppy.js"],"names":["$","global_version","global_org_template_html","global_isinit","global_selector","cppy","append","version","create","param","_cppy","this","prepare_data","data","obj","each","key","ele","type","_switch_background","html","target","find","element","url","attr","tagName","css","removeAttr","outerHTML","template","datalist","_is_init","box","boxkey","datainfo","key2val","mix_html_code","join","code","val","re","RegExp","replace","_set_init","bool","put","newcode","after","first","remove","last","_set_selector","_is_exist_selector","length","main","input_data","fn","selector","jQuery"],"mappings":";CAAC,SAAUA,GAEP,GAAIC,GAA2B,QAC3BC,GAA2B,EAC3BC,GAA2B,EAC3BC,GAA2B,CAC/BJ,GAAEK,QAGFL,EAAE,QAAQM,OAAO,iDAGjBN,EAAEK,KAAKE,QAAU,WACb,MAAON,IAIXD,EAAEK,KAAKG,OAAS,SAAUC,GAEtB,GAAIC,EAIJC,MAAKC,aAAe,SAAUC,GAC1B,GAAIC,KAYJ,OAXAd,GAAEe,KAAKF,EAAM,SAAUG,EAAKC,GASxB,MAPoB,WAAhBjB,EAAEkB,KAAKD,GACPH,EAAMD,EAINC,EAAI,GAAKD,GAEN,IAEJC,EAGX,IAAIK,GAAqB,SAAUC,GAE/B,GAAIC,GAASrB,EAAEoB,EAiBf,OAfAC,GAAOC,KAAK,0BAA0BP,KAAK,SAAUC,EAAKO,GAEtD,GAAIC,GAAMxB,EAAEuB,GAASE,KAAK,uBAEI,SAA1BzB,EAAEuB,GAAS,GAAGG,QACd1B,EAAEuB,GAASE,KAAK,MAAOD,GAGvBxB,EAAEuB,GAASI,IAAI,mBAAoB,OAAOH,EAAI,IAGrCxB,GAAEuB,GAASK,WAAW,0BAIhCP,EAAO,GAAGQ,UAIrBlB,MAAKmB,SAAW,SAAUC,GAGlBC,OAAe,IACf9B,EAA2BF,EAAEI,GAAiB,GAAGyB,UAGrD,IAAII,MACAC,EAAS,CAGblC,GAAEe,KAAKgB,EAAU,SAAUf,EAAKmB,GAC5BF,EAAIC,GAAUxB,EAAM0B,QAAQlC,EAA0BiC,GACtDF,EAAIC,GAAUf,EAAmBc,EAAIC,IACrCA,KAGJ,IAAIG,GAAgBJ,EAAIK,KAAK,GAE7B,OAAOD,IAGX1B,KAAKyB,QAAU,SAAUG,EAAMJ,GAC3B,GAAId,GAASkB,CAKb,OAJAvC,GAAEe,KAAKoB,EAAU,SAAUnB,EAAKwB,GAC5B,GAAIC,GAAK,GAAIC,QAAO,MAAQ1B,EAAK,IACjCK,GAASA,EAAOsB,QAAQF,EAAID,KAEzBnB,EAIX,IAAIW,GAAW,WACX,MAAO7B,MAAkB,GAIzByC,EAAY,SAAUC,GACtB1C,EAAgB0C,EAIpBlC,MAAKmC,IAAM,SAAUC,GAGbf,OAAe,GACfhC,EAAEI,GAAiB4C,MAAMD,GACzB/C,EAAEI,GAAiB6C,QAAQC,UAI3BlD,EAAEI,GAAiB+C,OAAOH,MAAMD,GAIpC/C,EAAEI,GAAiBwB,WAAW,kBAIlC,IAAIwB,GAAgB,SAAUnC,GAE1B,MAAIb,KAAoBa,GAAY,GAGpCb,EAAkBa,EAClB2B,GAAU,IAEH,IAIPS,EAAqB,WACrB,MAAOrD,GAAEI,GAAiBkD,QAAU,EAGxC3C,MAAK4C,KAAO,SAAU9C,GAMlB,GAJAC,EAAWC,KACXyC,EAAc3C,EAAMQ,KAGhBoC,OAAyB,EAAO,OAAO,CAG3C,IAAIG,GAAa9C,EAAME,aAAaH,EAAMI,MAEtCkC,EAAUrC,EAAMoB,SAAS0B,EAE7B9C,GAAMoC,IAAIC,GAINf,OAAe,GAAOY,GAAU,IAKxCjC,KAAK4C,KAAK9C,IAGdT,EAAEyD,GAAGpD,KAAO,SAASqD,EAAU7C,GAC3Bb,EAAEK,KAAKG,QACHS,IAAKyC,EACL7C,KAAMA,MAIf8C","file":"jquery.cppy.min.js","sourcesContent":["(function ($) {\r\n\r\n    var global_version           = \"2.0.0\";\r\n    var global_org_template_html = false; // 原始模板\r\n    var global_isinit            = false;\r\n    var global_selector          = false; // 選擇棄\r\n    $.cppy                       = {}\r\n\r\n    // 預先隱藏\r\n    $(\"head\").append(\"<style>[data-cppy-temp]{display:none}</style>\");\r\n\r\n    // 版本\r\n    $.cppy.version = function (){\r\n        return global_version;\r\n    }\r\n    \r\n\r\n    $.cppy.create = function (param){\r\n    \r\n        var _cppy;\r\n\r\n\r\n        // 無論如何都轉為二維\r\n        this.prepare_data = function (data){\r\n            var obj = {};\r\n            $.each(data, function (key, ele){\r\n                // 二維\r\n                if ($.type(ele) === \"object\"){\r\n                    obj = data;\r\n                }\r\n                // 一維\r\n                else {\r\n                    obj[0] = data;\r\n                }\r\n                return false;\r\n            })\r\n            return obj;\r\n        }\r\n\r\n        var _switch_background = function (html){\r\n\r\n            var target = $(html);\r\n\r\n            target.find(\"[data-cppy-background]\").each(function (key, element){\r\n                \r\n                var url = $(element).attr(\"data-cppy-background\");\r\n\r\n                if ($(element)[0].tagName === \"IMG\") {\r\n                    $(element).attr(\"src\", url);\r\n                }\r\n                else {\r\n                    $(element).css(\"background-image\", \"url(\"+url+\")\")\r\n                }\r\n\r\n                var result = $(element).removeAttr('data-cppy-background');\r\n\r\n            })\r\n\r\n            return target[0].outerHTML;\r\n        }\r\n\r\n        // 模板處理\r\n        this.template = function (datalist){\r\n\r\n            // 第一次?\r\n            if (_is_init() === false){\r\n                global_org_template_html = $(global_selector)[0].outerHTML;\r\n            }\r\n\r\n            var box    = [];\r\n            var boxkey = 0;\r\n            \r\n            // 批次替換後合併。 如 {id: 100} ，會把 $id 替換為 100\r\n            $.each(datalist, function (key, datainfo){\r\n                box[boxkey] = _cppy.key2val(global_org_template_html, datainfo);\r\n                box[boxkey] = _switch_background(box[boxkey]);\r\n                boxkey++;\r\n            })\r\n\r\n            var mix_html_code = box.join('');\r\n\r\n            return mix_html_code;\r\n        }\r\n\r\n        this.key2val = function (code, datainfo){\r\n            var target = code;\r\n            $.each(datainfo, function (key, val){\r\n                var re = new RegExp(\"\\\\$\" + key, \"g\");\r\n                target = target.replace(re, val)\r\n            })\r\n            return target;\r\n        }\r\n\r\n        // 初始化?\r\n        var _is_init = function (){\r\n            return global_isinit === true;\r\n        }\r\n\r\n        // 設定初始標記\r\n        var _set_init = function (bool){\r\n            global_isinit = bool;\r\n        }\r\n\r\n        // 將新的編碼換置原來的模板位置\r\n        this.put = function (newcode){\r\n\r\n            //第一次，就加入模板後方，並將模板移除\r\n            if (_is_init() === false) {\r\n                $(global_selector).after(newcode);\r\n                $(global_selector).first().remove();\r\n            }\r\n            //第二次以後，在所有元素的後方加入\r\n            else {\r\n                $(global_selector).last().after(newcode)\r\n            }\r\n\r\n            // 顯示\r\n            $(global_selector).removeAttr('data-cppy-temp');\r\n        }\r\n\r\n        // 指派選擇器\r\n        var _set_selector = function (ele){\r\n\r\n            if (global_selector === ele) return false;\r\n            \r\n            // 若是新的選擇器，需要將重設初始化標記\r\n            global_selector = ele;\r\n            _set_init(false);\r\n\r\n            return true;\r\n        }\r\n\r\n        // 目標存在？\r\n        var _is_exist_selector = function (){\r\n            return $(global_selector).length >= 0;\r\n        }\r\n\r\n        this.main = function (param){\r\n\r\n            _cppy    = this;\r\n            _set_selector(param.ele);\r\n\r\n            // 忽略不存在\r\n            if (_is_exist_selector() === false) return false;\r\n\r\n            // 無論如何都轉為二維\r\n            var input_data = _cppy.prepare_data(param.data);\r\n\r\n            var newcode = _cppy.template(input_data);\r\n\r\n            _cppy.put(newcode);\r\n\r\n\r\n            // 初始化標記\r\n            if (_is_init() === false) _set_init(true);\r\n        }\r\n\r\n\r\n\r\n        this.main(param);\r\n    }\r\n    \r\n    $.fn.cppy = function(selector, data) {\r\n        $.cppy.create({\r\n            ele: selector,\r\n            data: data\r\n        })\r\n    };\r\n\r\n}( jQuery ));\r\n"]}